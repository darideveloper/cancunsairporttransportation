---
// Layout
import Layout from "../../layouts/Layout.astro";

// Libs
import { useTranslations } from "../../lib/i18n/utils";
import { getStaticPathsLangs } from "../../lib/utils";
import { marked } from "marked";

// i18n
export const getStaticPaths = getStaticPathsLangs;

// Components
import PageSEO from "../../components/utils/PageSEO.astro";
import BannerImage from "../../components/atoms/BannerImage.astro";
import BookingForm from "../../components/organisms/BookingForm.astro";
import TextCard from "../../components/molecules/TextCard.astro";
import BannerCta from "../../components/organisms/BannerCta.astro";
import BannerStats from "../../components/organisms/BannerStats.astro";
import PricingCard from "../../components/molecules/PricingCard.astro";
import SectionHeading from "../../components/molecules/SectionHeading.astro";
import Testimonials from "../../components/organisms/Testimonials.astro";
import { Image } from "astro:assets";

// Images
const bannerSrc = "/images/home-banner.webp";
import safeTripBookingImg from "../../assets/images/trip-advisor.webp";
import luxuryVehicleImg from "../../assets/images/vehicles/luxury.webp";
import privateVehicleImg from "../../assets/images/vehicles/standard.webp";
import groupVehicleImg from "../../assets/images/vehicles/groups.webp";
import tulumImg from "../../assets/images/destinations/tulum.webp";
import playaImg from "../../assets/images/destinations/playa-del-carmen.webp";
import cancunImg from "../../assets/images/destinations/cancun.webp";

// Props
interface Props {
  lang: string;
}
// Get language from params or props
const { lang } = (Astro.params as any) || (Astro.props as any);

// Tranlation texts
const t = useTranslations(lang);
const safeTripBookContent = await marked.parse(t("safeTripBooking.text"));

// Data
const pricingTransportation = [
  {
    key: "luxury",
    image: luxuryVehicleImg,
    bestSeller: false,
  },
  {
    key: "private",
    image: privateVehicleImg,
    bestSeller: true,
  },
  {
    key: "group",
    image: groupVehicleImg,
    bestSeller: false,
  },
];

const destinations = [
  {
    id: "tulum",
    image: tulumImg,
  },
  {
    id: "playa",
    image: playaImg,
  },
  {
    id: "cancun",
    image: cancunImg,
  },
];
---

<Layout>
  <PageSEO currentPage="home" lang={lang} slot="seo" />
  <BannerImage src={bannerSrc}>
    <h1 class="mx-auto w-11/12 text-5xl font-bold">
      {t("pages.home.bannerTitle")}
    </h1>
  </BannerImage>
  <BookingForm
    id="booking-form"
    defaultFrom="cun"
    defaultTo="merida"
    class="-mt-28"
  />
  <TextCard
    id="safe-trip-booking"
    title={t("safeTripBooking.title")}
    image={safeTripBookingImg}
    alt={t("safeTripBooking.imageAlt")}
    width={700}
    height={400}
    class="mt-12"
    classImage="object-right"
    reverse={true}
  >
    <div set:html={safeTripBookContent} class="markdown" />
  </TextCard>

  <!-- Banner CTA -->
  <BannerCta
    title={t("cancunAirportTransportation.title")}
    text={t("cancunAirportTransportation.text")}
    lang={lang}
  />

  <!-- Pricing transportation -->
  <section
    id="pricing-transportation"
    class="container mt-12"
    aria-labelledby="pricing-transportation-heading"
  >
    <SectionHeading
      id="pricing-transportation-heading"
      title={t("pricingTransportation.title")}
      class="text-center"
    >
      <p>
        {t("pricingTransportation.text")}
      </p>
    </SectionHeading>

    <ul
      class="mt-4 grid grid-cols-1 items-end justify-center gap-8 md:grid-cols-3 md:flex-row"
      role="list"
    >
      {
        pricingTransportation.map((card) => (
          <li>
            <PricingCard
              title={t(`pricingTransportation.cards.${card.key}.title`)}
              price={t(`pricingTransportation.cards.${card.key}.price`)}
              ctaLink="#booking-form"
              ctaText={t(`pricingTransportation.cards.${card.key}.ctaText`)}
              bestSeller={card.bestSeller}
              currency={lang === "es" ? "mxn" : "usd"}
              class="pt-4"
            >
              <Image
                slot="image"
                src={card.image}
                alt={t(`pricingTransportation.cards.${card.key}.imageAlt`)}
                title={t(`pricingTransportation.cards.${card.key}.imageTitle`)}
                loading="lazy"
                decoding="async"
                class="mx-auto w-9/12"
              />
              <div
                slot="content"
                set:html={marked.parse(
                  t(`pricingTransportation.cards.${card.key}.description`),
                )}
                class="markdown"
              />
            </PricingCard>
          </li>
        ))
      }
    </ul>
  </section>

  <BannerStats />
  <Testimonials />

  <!-- Destinations -->
  <section class="destinations-elements container mt-12">
    <SectionHeading
      class="top text-center"
      title={t("pages.home.destinations.title")}
    >
      <p>{t("pages.home.destinations.text")}</p>
    </SectionHeading>

    <ul
      class="middle mt-12 grid grid-cols-1 gap-8 md:grid-cols-3 md:gap-4 lg:gap-8"
    >
      {
        destinations.map((dest) => (
          <li>
            <PricingCard
              title={t(`pages.home.destinations.cards.${dest.id}.title`)}
              price={t(`pages.home.destinations.cards.${dest.id}.price`)}
              ctaLink={t(`pages.home.destinations.cards.${dest.id}.link`)}
              ctaText={t(`pages.home.destinations.cards.${dest.id}.ctaText`)}
              currency={lang === "es" ? "mxn" : "usd"}
              bestSeller={false}
              reverse={true}
              class="hover:border-accent text-center transition-all duration-300 md:text-left"
            >
              <Image
                slot="image"
                src={dest.image}
                alt={t(`pages.home.destinations.cards.${dest.id}.title`)}
                width={700}
                height={700}
                class="mx-auto aspect-4/3 w-full rounded-t-lg object-cover md:aspect-12/11 lg:aspect-4/3"
              />
              <div
                slot="content"
                set:html={marked.parse(
                  t(`pages.home.destinations.cards.${dest.id}.description`),
                )}
                class="markdown text-justify text-sm"
              />
            </PricingCard>
          </li>
        ))
      }
    </ul>

    <div class="bottom mt-12 text-center">
      <a
        href={t("pages.home.destinations.viewMoreLink")}
        class="btn bg-accent inline-block rounded-lg px-6 py-3 font-bold text-white transition hover:opacity-90"
        title={t("pages.home.destinations.viewMore")}
      >
        {t("pages.home.destinations.viewMore")}
      </a>
    </div>
  </section>
</Layout>
