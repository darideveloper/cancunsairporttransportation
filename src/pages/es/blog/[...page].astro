---
import type { GetStaticPaths, Page } from "astro";
import type { Post } from "../../../types/blog";
import BlogListing from "../../../components/pages/blog/BlogListing.astro";
import { getPosts } from "../../../lib/blog/api";

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  const posts = await getPosts("es");
  const sortedPosts = posts.sort(
    (a, b) =>
      new Date(b.created_at).getTime() - new Date(a.created_at).getTime(),
  );

  return paginate(sortedPosts, { pageSize: 9 });
};

interface Props {
  page: Page<Post>;
}

const { page } = Astro.props;
---

<BlogListing
  posts={page.data}
  lang="es"
  currentPage={page.currentPage}
  lastPage={page.lastPage}
  prevUrl={page.url.prev}
  nextUrl={page.url.next}
/>
