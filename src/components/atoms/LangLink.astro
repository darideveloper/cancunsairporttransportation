---
import { getLangFromUrl } from '../../lib/i18n/utils'
import { languages } from '../../lib/i18n/ui'

const lang = getLangFromUrl(Astro.url)
const isSpanish = lang === 'es'
const targetLang = isSpanish ? 'en' : 'es'
const label = languages[targetLang]
const currentRoute = Astro.url.pathname

// Simple route switcher for /[lang]/...
const segments = currentRoute.split('/').filter(Boolean)
if (segments.length > 0 && (segments[0] === 'en' || segments[0] === 'es')) {
  segments[0] = targetLang
} else {
  segments.unshift(targetLang)
}
const targetUrl = `/${segments.join('/')}/`
---

<div class='flex items-center gap-1 text-inherit'>
  <span>{isSpanish ? 'Idioma:' : 'Language:'}</span>
  <a
    href={targetUrl}
    class='hover:text-brand-primary transition-colors font-medium border-b border-transparent hover:border-brand-primary'
    title={`Switch to ${label}`}
  >
    {label}
  </a>
</div>
