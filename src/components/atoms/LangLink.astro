---
import {
  getLangFromUrl,
  useTranslations,
  getLocalizedPath,
} from "../../lib/i18n/utils";
import { languages } from "../../lib/i18n/ui";

interface Props {
  pageKey?: string;
  translatedPath?: string;
}

const { pageKey, translatedPath } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const isSpanish = lang === "es";
const targetLang = isSpanish ? "en" : "es";
const label = languages[targetLang];

const targetUrl =
  translatedPath ||
  (pageKey
    ? getLocalizedPath(pageKey, targetLang)
    : targetLang === "es"
      ? "/es"
      : "/");
---

<div class="flex items-center gap-1 text-inherit">
  <span>{t("global.topbar.languageLabel")}:</span>
  <a
    href={targetUrl}
    class="hover:text-brand-primary hover:border-brand-primary text-accent-dark border-b border-transparent font-medium transition-colors"
    title={`${t("global.topbar.switchLanguage")} ${label}`}
  >
    {label}
  </a>
</div>
