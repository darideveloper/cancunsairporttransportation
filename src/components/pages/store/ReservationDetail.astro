---
// Layout
import Layout from '../../../layouts/Layout.astro'

// Libs
import { getTranslations } from '../../../lib/i18n/utils'
import PageSEO from '../../../components/utils/PageSEO.astro'
import {
  FaCheckCircle,
  FaUser,
  FaPhoneAlt,
  FaEnvelope,
  FaShieldAlt,
} from 'react-icons/fa'

// Components
import ButtonCta from '../../../components/atoms/ButtonCta'
import BookingSummary from '../../../components/molecules/booking/BookingSummary'
import H2 from '../../../components/atoms/H2'

// Assets
import stripeLogo from '../../../assets/images/checkout/payment/stripe.webp'
import visaIcon from '../../../assets/images/checkout/payment/visa.png'
import mastercardIcon from '../../../assets/images/checkout/payment/mastercard.png'
import unionPayIcon from '../../../assets/images/checkout/payment/unionpay.png'

interface Props {
  lang: 'en' | 'es'
  pageKey: string
}

const { lang, pageKey } = Astro.props
const t = getTranslations(lang)

// Mock Data (To be replaced with real data fetching later)
const mockReservation = {
  code: '8V6LTSosO',
  service: 'Suburban',
  passengers: 1,
  from: 'Puerto Juarez',
  to: 'Akumal',
  pickupDate: '2026-03-03 12:00:00',
  vehicle: {
    id: 'suburban',
    name: 'Suburban',
    price: 1.0,
    maxPassengers: 6,
    image: '', // Needs a valid image URL or import if we challenge that
    type: 'private',
  },
  user: {
    name: 'Marcelo Rodriguez',
    phone: '+1756765867',
    email: 'jvso9414@gmail.com',
  },
}

// Prepare selectedVehicle object for BookingSummary
const selectedVehicle = {
  id: mockReservation.vehicle.id,
  name: mockReservation.vehicle.name,
  price: mockReservation.vehicle.price,
  maxPassengers: mockReservation.vehicle.maxPassengers,
  image: mockReservation.vehicle.image,
  type: mockReservation.vehicle.type as 'private' | 'luxury' | 'group',
}
---

<Layout pageKey={pageKey}>
  <PageSEO
    currentPage='reservationDetail'
    slot='seo'
  />

  <section class='min-h-screen bg-gray-50 py-12'>
    <div class='container mx-auto max-w-6xl px-4'>
      {/* Header Section */}
      <div class='mb-12 text-center'>
        <h1 class='mb-8 text-4xl font-bold text-black'>
          {t('pages.reservationDetail.heading')}
        </h1>

        <div class='flex flex-col items-center gap-4'>
          <FaCheckCircle className='text-blue text-7xl' />

          <div
            class='mt-4 flex flex-col items-center gap-4 text-gray-700 md:flex-row md:gap-8'
          >
            <span class='text-lg font-bold'
              >{
                t('pages.reservationDetail.user.greeting', {
                  name: mockReservation.user.name,
                })
              }</span
            >
            <div class='flex items-center gap-2'>
              <span class='text-lg font-bold'>#</span>
              {mockReservation.user.phone}
            </div>
            <div class='flex items-center gap-2'>
              <FaEnvelope />
              {mockReservation.user.email}
            </div>
          </div>

          <div
            class='mt-4 flex flex-col items-center gap-4 border-l-0 border-gray-300 pl-0 md:flex-row md:border-l md:pl-8'
          >
            <div class='flex flex-col text-left'>
              <span class='text-sm font-bold text-black'
                >{t('pages.reservationDetail.user.statusLabel')}</span
              >
              <span
                class='border-blue text-blue w-fit rounded border px-2 py-1 text-xs font-bold'
                >CONFIRMED</span
              >
            </div>
            <ButtonCta
              variant='red'
              className='px-4! py-2! text-xs!'
            >
              {t('pages.reservationDetail.user.logout')}
            </ButtonCta>
          </div>
        </div>
      </div>

      <div class='grid grid-cols-1 gap-8 lg:grid-cols-3'>
        {/* Left Column: Details */}
        <div class='space-y-6 lg:col-span-2'>
          {/* Status Card */}
          <div
            class='border-accent rounded-r-lg border-l-4 bg-white p-6 shadow-sm'
          >
            <h3 class='mb-2 text-lg font-bold'>
              {t('pages.reservationDetail.user.statusLabel')}
            </h3>
            <span class='text-accent text-xl font-bold uppercase'
              >CONFIRMED</span
            >
          </div>

          {/* Details Table */}
          <div
            class='overflow-hidden rounded-xl border border-gray-200 bg-white shadow-sm'
          >
            <table class='w-full border-collapse text-left'>
              <tbody>
                <tr class='border-b border-gray-100'>
                  <th class='w-1/3 bg-gray-50 px-6 py-4 font-bold text-gray-700'
                    >{t('pages.reservationDetail.details.code')}</th
                  >
                  <td class='px-6 py-4 text-gray-900'>{mockReservation.code}</td
                  >
                </tr>
                <tr class='border-b border-gray-100'>
                  <th class='w-1/3 bg-gray-50 px-6 py-4 font-bold text-gray-700'
                    >{t('pages.reservationDetail.details.service')}</th
                  >
                  <td class='px-6 py-4 text-gray-900'
                    >{mockReservation.service}</td
                  >
                </tr>
                <tr class='border-b border-gray-100'>
                  <th class='w-1/3 bg-gray-50 px-6 py-4 font-bold text-gray-700'
                    >{t('pages.reservationDetail.details.passengers')}</th
                  >
                  <td class='px-6 py-4 text-gray-900'
                    >{mockReservation.passengers}</td
                  >
                </tr>
                <tr class='border-b border-gray-100'>
                  <th class='w-1/3 bg-gray-50 px-6 py-4 font-bold text-gray-700'
                    >{t('pages.reservationDetail.details.from')}</th
                  >
                  <td class='px-6 py-4 text-gray-900'>{mockReservation.from}</td
                  >
                </tr>
                <tr class='border-b border-gray-100'>
                  <th class='w-1/3 bg-gray-50 px-6 py-4 font-bold text-gray-700'
                    >{t('pages.reservationDetail.details.to')}</th
                  >
                  <td class='px-6 py-4 text-gray-900'>{mockReservation.to}</td>
                </tr>
                <tr>
                  <th class='w-1/3 bg-gray-50 px-6 py-4 font-bold text-gray-700'
                    >{t('pages.reservationDetail.details.pickup')}</th
                  >
                  <td class='px-6 py-4 text-gray-900'
                    >{mockReservation.pickupDate}</td
                  >
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        {/* Right Column: Payment Summary */}
        <div class='space-y-6'>
          <H2 className='text-blue text-xl'
            >{t('pages.reservationDetail.payment.methods')}</H2
          >

          <BookingSummary
            lang={lang}
            selectedVehicle={selectedVehicle}
            currency='USD'
            passengers={mockReservation.passengers}
          />

          <div class='rounded-xl border border-gray-200 bg-white p-4 shadow-sm'>
            <div
              class='mb-4 flex items-center justify-center gap-2 text-sm font-bold text-gray-600'
            >
              <FaShieldAlt />
              {t('pages.reservationDetail.payment.secure')}
              <img
                src={stripeLogo.src}
                alt='Stripe'
                class='h-4'
              />
            </div>
            <div class='flex flex-wrap justify-center gap-2'>
              <img
                src={visaIcon.src}
                alt='Visa'
                class='h-6'
              />
              <img
                src={mastercardIcon.src}
                alt='Mastercard'
                class='h-6'
              />
              {
                /* Placeholder for other icons if they don't exist, checking imports first */
              }
              {
                /*  <img src={amexIcon.src} alt="Amex" class="h-6" />
                    <img src={jcbIcon.src} alt="JCB" class="h-6" />
                    <img src={discoverIcon.src} alt="Discover" class="h-6" />
                    <img src={unionPayIcon.src} alt="UnionPay" class="h-6" /> */
              }
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>
