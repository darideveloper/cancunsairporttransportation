---
// Layout
import Layout from "../../../layouts/Layout.astro";

// Libs
import { useTranslations } from "../../../lib/i18n/utils";
import { getStaticPathsLangs } from "../../../lib/utils";
import { marked } from "marked";

// i18n
// export const getStaticPaths = getStaticPathsLangs;

// Components
import { Image } from "astro:assets";
import PageSEO from "../../../components/utils/PageSEO.astro";
import BookingForm from "../../../components/organisms/BookingForm";
import SectionHeading from "../../../components/molecules/SectionHeading.astro";
import PricingCard from "../../../components/molecules/PricingCard.astro";
import BasicImageCard from "../../../components/molecules/BasicImageCard.astro";

// Images
import tulumImg from "../../../assets/images/destinations/tulum.webp";
import playaImg from "../../../assets/images/destinations/playa-del-carmen.webp";
import cancunImg from "../../../assets/images/destinations/cancun.webp";
import bookNowImg from "../../../assets/images/destinations/book-now.png";
import customerServiceImg from "../../../assets/images/destinations/customer-service.png";
import homeBannerImg from "../../../assets/images/home-banner.webp";

// Page data
const page = "destinations";

// Props
interface Props {
  lang: "en" | "es";
  pageKey: string;
}
// Get language from params or props
const { lang, pageKey } = Astro.props;

// Tranlation texts
const t = useTranslations(lang);

// Data
const destinations = [
  {
    id: "tulum",
    image: tulumImg,
  },
  {
    id: "playa",
    image: playaImg,
  },
  {
    id: "cancun",
    image: cancunImg,
  },
];
---

<Layout preloadImage={homeBannerImg.src} pageKey={pageKey}>
  <!-- Page SEO -->
  <PageSEO currentPage={page} slot="seo" />

  <section class="container mx-auto px-4 py-12">
    <div class="mb-8 max-w-3xl">
      <p class="text-accent mb-2 text-sm font-bold tracking-wider uppercase">
        {t("pages.destinations.tagline")}
      </p>
      <SectionHeading title={t("pages.destinations.title")}>
        <div
          class="text-gray-dark leading-relaxed"
          set:html={marked.parse(t("pages.destinations.description"))}
        />
      </SectionHeading>
    </div>

    <div class="grid grid-cols-1 gap-12 lg:grid-cols-3">
      <div class="lg:col-span-2">
        <ul class="grid grid-cols-1 gap-8 md:grid-cols-2">
          {
            destinations.map((dest) => (
              <li>
                <PricingCard
                  title={t(`pages.${page}.destinations.cards.${dest.id}.title`)}
                  price={t(`pages.${page}.destinations.cards.${dest.id}.price`)}
                  ctaLink={t(
                    `pages.${page}.destinations.cards.${dest.id}.link`,
                  )}
                  ctaText={t(
                    `pages.${page}.destinations.cards.${dest.id}.ctaText`,
                  )}
                  currency={lang === "es" ? "mxn" : "usd"}
                  bestSeller={false}
                  reverse={true}
                  class="hover:border-accent h-full transition-all duration-300"
                >
                  <Image
                    slot="image"
                    src={dest.image}
                    alt={t(`pages.${page}.destinations.cards.${dest.id}.title`)}
                    widths={[300, 600, dest.image.width]}
                    quality={60}
                    format="avif"
                    loading="lazy"
                    decoding="async"
                    class="aspect-2/1 w-full rounded-t-lg object-cover"
                  />
                  <div
                    slot="content"
                    set:html={marked.parse(
                      t(
                        `pages.${page}.destinations.cards.${dest.id}.description`,
                      ),
                    )}
                    class="markdown text-justify text-sm"
                  />
                </PricingCard>
              </li>
            ))
          }
        </ul>

        <div class="mt-12 grid grid-cols-1 gap-8 md:grid-cols-2">
          <BasicImageCard
            title={t(`pages.${page}.highlights.reserve.title`)}
            image={{
              src: bookNowImg,
              alt: t(`pages.${page}.highlights.reserve.imageAlt`),
              title: t(`pages.${page}.highlights.reserve.imageTitle`),
            }}
          >
            <div
              set:html={marked.parse(
                t(`pages.${page}.highlights.reserve.text`),
              )}
              class="markdown"
            />
          </BasicImageCard>

          <BasicImageCard
            title={t(`pages.${page}.highlights.contact.title`)}
            image={{
              src: customerServiceImg,
              alt: t(`pages.${page}.highlights.contact.imageAlt`),
              title: t(`pages.${page}.highlights.contact.imageTitle`),
            }}
          >
            <div
              set:html={marked.parse(
                t(`pages.${page}.highlights.contact.text`),
              )}
              class="markdown"
            />
          </BasicImageCard>
        </div>
      </div>

      <aside>
        <div class="sticky top-20">
          <!-- Form -->
          <div class="form-wrapper debug @container w-full">
            <BookingForm
              translations={t("global.booking")}
              defaultFrom="cun"
              defaultTo="merida"
              client:idle
              className="px-0!"
            />
          </div>
        </div>
      </aside>
    </div>
  </section>
</Layout>
