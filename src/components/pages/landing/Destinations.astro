---
// Layout
import Layout from "../../../layouts/Layout.astro";

// Libs
import { useTranslations } from "../../../lib/i18n/utils";
import { getStaticPathsLangs } from "../../../lib/utils";
import { marked } from "marked";

// i18n
// export const getStaticPaths = getStaticPathsLangs;

// Components
import { Image } from "astro:assets";
import PageSEO from "../../../components/utils/PageSEO.astro";
import BookingForm from "../../../components/organisms/BookingForm";
import SectionHeading from "../../../components/molecules/SectionHeading.astro";
import PricingCard from "../../../components/molecules/PricingCard.astro";
import BasicImageCard from "../../../components/molecules/BasicImageCard.astro";

// Images
import tulumImg from "../../../assets/images/destinations/tulum.webp";
import playaImg from "../../../assets/images/destinations/playa-del-carmen.webp";
import cancunImg from "../../../assets/images/destinations/cancun.webp";
import bookNowImg from "../../../assets/images/destinations/book-now.png";
import customerServiceImg from "../../../assets/images/destinations/customer-service.png";
import homeBannerImg from "../../../assets/images/home-banner.webp";

// Page data
const page = "destinations";

// Props
interface Props {
  lang: "en" | "es";
  pageKey: string;
}
// Get language from params or props
const { lang, pageKey } = Astro.props;

// Tranlation texts
const t = useTranslations(lang);

// Data
const destinations = [
  {
    id: "tulum",
    image: tulumImg,
  },
  {
    id: "playa",
    image: playaImg,
  },
  {
    id: "cancun",
    image: cancunImg,
  },
];
---

<Layout preloadImage={homeBannerImg.src} pageKey={pageKey}>
  <!-- Page SEO -->
  <PageSEO currentPage={page} slot="seo" />

  <section
    class="debug container flex flex-col-reverse gap-6 md:flex-row md:gap-4"
  >
    <!-- Content -->
    <div class="content md:w-1/2 lg:w-2/3">
      <!-- Heading -->
      <div class="">
        <p class="">
          {t("pages.destinations.tagline")}
        </p>
        <SectionHeading title={t("pages.destinations.title")}>
          <div
            class=""
            set:html={marked.parse(t("pages.destinations.description"))}
          />
        </SectionHeading>
      </div>

      <!-- Destinations -->
      <ul class="mt-12 grid grid-cols-1 gap-6 lg:grid-cols-2 xl:grid-cols-3">
        {
          destinations.map((dest) => (
            <li>
              <PricingCard
                title={t(`pages.${page}.destinations.cards.${dest.id}.title`)}
                price={t(`pages.${page}.destinations.cards.${dest.id}.price`)}
                ctaLink={t(`pages.${page}.destinations.cards.${dest.id}.link`)}
                ctaText={t(
                  `pages.${page}.destinations.cards.${dest.id}.ctaText`,
                )}
                currency={lang === "es" ? "mxn" : "usd"}
                bestSeller={false}
                reverse={true}
                class=""
              >
                <Image
                  slot="image"
                  src={dest.image}
                  alt={t(`pages.${page}.destinations.cards.${dest.id}.title`)}
                  widths={[300, 600, dest.image.width]}
                  quality={60}
                  format="avif"
                  loading="lazy"
                  decoding="async"
                  class="w-full"
                />
                <div
                  slot="content"
                  set:html={marked.parse(
                    t(
                      `pages.${page}.destinations.cards.${dest.id}.description`,
                    ),
                  )}
                  class=""
                />
              </PricingCard>
            </li>
          ))
        }
      </ul>

      <!-- Highlights -->
      <div class="mt-12">
        <BasicImageCard
          title={t(`global.sections.highlights.reserve.title`)}
          image={{
            src: bookNowImg,
            alt: t(`global.sections.highlights.reserve.imageAlt`),
            title: t(`global.sections.highlights.reserve.imageTitle`),
          }}
        >
          <div
            set:html={marked.parse(t(`pages.${page}.highlights.reserve.text`))}
            class=""
          />
        </BasicImageCard>

        <BasicImageCard
          title={t(`global.sections.highlights.contact.title`)}
          image={{
            src: customerServiceImg,
            alt: t(`global.sections.highlights.contact.imageAlt`),
            title: t(`global.sections.highlights.contact.imageTitle`),
          }}
        >
          <div
            set:html={marked.parse(t(`pages.${page}.highlights.contact.text`))}
            class=""
          />
        </BasicImageCard>
      </div>
    </div>

    <!-- Sidebar -->
    <aside class="debug @container -mx-6 md:mx-0 md:w-1/2 lg:w-1/3">
      <!-- Form -->
      <BookingForm
        translations={t("global.booking")}
        defaultFrom="cun"
        defaultTo="merida"
        client:idle
        className="debug md:px-0!"
      />
    </aside>
  </section>
</Layout>
