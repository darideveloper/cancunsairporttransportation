---
import { Image } from 'astro:assets'
import { FaStar } from 'react-icons/fa'
import ButtonCta from '../atoms/ButtonCta.astro'
import { clsx } from 'clsx'
import type { ImageMetadata } from 'astro'

interface Props {
  imageFile: ImageMetadata
  imageAlt: string
  imageTitle?: string
  title: string
  bestSeller?: boolean
  price: number | string
  ctaLink: string
  ctaText: string
  reverse?: boolean
  currency?: 'usd' | 'mxn'
}

const {
  imageFile,
  imageAlt,
  imageTitle,
  title,
  bestSeller = false,
  price,
  ctaLink,
  ctaText,
  reverse = false,
  currency = 'usd',
} = Astro.props
---

<article
  class={clsx(
    'pricing-card flex flex-col items-center justify-center gap-4 p-4 rounded-xl border bg-gray-light',
    bestSeller ? 'border-accent' : 'border-gray-dark/20'
  )}
>
  <header>
    {/* Best Seller Badge */}
    {
      bestSeller && (
        <div
          class='badge-best-seller text-blue mb-3 flex items-center justify-center gap-2'
          role='status'
          aria-label='Recommendation: Most Popular'
        >
          <FaStar aria-hidden='true' />
          <span>MostPopular</span>
        </div>
      )
    }

    <div
      class={clsx(
        `title-image text-center flex items-center justify-center gap-2`,
        reverse ? 'flex-col-reverse' : 'flex-col'
      )}
    >
      {/* Layout Order Logic (title and image with optional reverse) */}
      <h3 class='text-lg font-bold'>{title}</h3>
      <div>
        <Image
          src={imageFile}
          alt={imageAlt}
          title={imageTitle}
          loading='lazy'
          class='w-full'
        />
      </div>
    </div>
  </header>

  {/* Price Section */}
  <div
    class='price-section text-blue flex items-center justify-center gap-2'
    aria-label={`Price starts from ${price} ${currency}`}
  >
    <span
      aria-hidden='true'
      class='inline-block text-xs'
    >
      Price
      <br />
      from
    </span>
    <span class='text-3xl font-bold'>
      <span
        class='price-value'
        aria-hidden='true'
      >
        {price}
      </span>
      <span
        class='price-currency uppercase'
        aria-hidden='true'
      >
        {currency}
      </span>
    </span>
  </div>

  {/* Dynamic Content */}
  <slot />

  <footer class='cta-container w-full'>
    {/* CTA Button */}
    <ButtonCta
      href={ctaLink}
      aria-label={`${ctaText} for ${title}`}
      class='inline-block w-full'
    >
      {ctaText}
    </ButtonCta>
  </footer>
</article>
