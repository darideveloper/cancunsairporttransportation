---
import type { Post } from "../../types/blog";
import { useTranslations } from "../../lib/i18n/utils";
import ButtonCta from "../atoms/ButtonCta.astro";

interface Props {
  post: Post;
  lang: "en" | "es";
}

const { post, lang } = Astro.props;
const t = useTranslations(lang);

const href = lang === "es" ? `/es/blog/${post.slug}` : `/blog/${post.slug}`;

// Format date
const date = new Date(post.created_at);
const formattedDate = date.toLocaleDateString(
  lang === "es" ? "es-MX" : "en-US",
  {
    year: "numeric",
    month: "long",
    day: "numeric",
  },
);
---

<div
  class="flex h-full flex-col overflow-hidden rounded-xl bg-white shadow-md transition-all duration-300 hover:-translate-y-1 hover:shadow-xl"
>
  <a href={href} class="block aspect-video w-full overflow-hidden">
    <img
      src={post.banner_image_url}
      alt={post.title}
      class="h-full w-full object-cover transition-transform duration-500 hover:scale-105"
      loading="lazy"
    />
  </a>
  <div class="flex flex-1 flex-col p-6">
    <div
      class="mb-3 flex items-center text-xs font-semibold tracking-wider text-gray-500 uppercase"
    >
      <span>{formattedDate}</span>
      <span class="mx-2">â€¢</span>
      <span>{post.author}</span>
    </div>

    <h3 class="mb-3 text-xl leading-tight font-bold text-gray-900">
      <a href={href} class="hover:text-accent transition-colors">
        {post.title}
      </a>
    </h3>

    <p class="mb-6 line-clamp-3 flex-1 text-sm leading-relaxed text-gray-600">
      {post.description}
    </p>

    <div class="mt-auto">
      <ButtonCta
        href={href}
        variant="blueGhost"
        class="w-full"
        ariaLabel={`${t("pages.blog.readMore")} - ${post.title}`}
      >
        {t("pages.blog.readMore")}
      </ButtonCta>
    </div>
  </div>
</div>
