---
// Libs
import { getLangFromUrl, useTranslations } from "../../lib/i18n/utils";
import { marked } from "marked";

// Components
import SectionHeading from "../molecules/SectionHeading.astro";
import ButtonCta from "../atoms/ButtonCta.astro";

// Lang
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// Data
const content = t("pages.privateAirportTransfer.privateDetails") as any;
const { title, description, table, cta } = content;
const descriptionHtml = await marked.parse(description);

// Table Data Interfaces
interface TableRow {
  arrival: string;
  departure: string;
  oneWay: string;
  roundTrip: string;
  capacity: string;
}

interface TableData {
  title: string;
  headers: {
    arrival: string;
    departure: string;
    oneWay: string;
    roundTrip: string;
    capacity: string;
  };
  rows: TableRow[];
}

const tableData = table as TableData;

// Column Configuration
interface TableColumn {
  key: keyof TableRow;
  header: string;
  className: string;
}

const columns: TableColumn[] = [
  {
    key: "arrival",
    header: tableData.headers.arrival,
    className: "",
  },
  {
    key: "departure",
    header: tableData.headers.departure,
    className: "",
  },
  {
    key: "capacity",
    header: tableData.headers.capacity,
    className: "",
  },
  {
    key: "oneWay",
    header: tableData.headers.oneWay,
    className: "",
  },
  {
    key: "roundTrip",
    header: tableData.headers.roundTrip,
    className: "",
  },
];
---

<section
  id="private-details"
  aria-labelledby="private-details-heading"
  class=""
>
  <div class="">
    <!-- Title Section -->
    <SectionHeading id="private-details-heading" title={title} class="">
      <div class="" set:html={descriptionHtml} />
    </SectionHeading>

    <!-- Table Section -->
    <div class="">
      <h3 class="">{tableData.title}</h3>
    </div>

    <!-- Responsive Table Wrapper -->
    <div class="">
      <table class="">
        <caption class="">{tableData.title}</caption>
        <thead class="">
          <tr>
            {
              columns.map((col) => (
                <th scope="col" class="">
                  {col.header}
                </th>
              ))
            }
          </tr>
        </thead>
        <tbody class="">
          {
            tableData.rows.map((row) => (
              <tr class="">
                {columns.map((col) => (
                  <td class={col.className}>{row[col.key]}</td>
                ))}
              </tr>
            ))
          }
        </tbody>
      </table>
    </div>

    <!-- CTA Button -->
    <div class="">
      <ButtonCta href={cta.href} class="">
        {cta.text}
      </ButtonCta>
    </div>
  </div>
</section>
